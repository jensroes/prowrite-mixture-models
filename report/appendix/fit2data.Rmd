# Fit to data

Model fit was assessed by testing to what extent simulations obtained from the model fit the observed data. From each model we obtained 100 simulations (predictions). These can be found in Figure \ref{fig:prediction}. The model predictions fitted the data substantially better for the mixture models. The worse fit was observed for the single distribution Gaussian model which predicted large amounts of negative keystroke intervals which are implausible. Using a log-normal distribution removed these negative keystroke intervals.

```{r eval = F}
theme_set(theme_few(base_size = 9) +
              theme(strip.background = element_blank(),
                    legend.position = "top",
                    legend.justification = "right",
                    panel.grid = element_blank(),
                    panel.background = element_rect(fill = "transparent"), # bg of the panel
                    plot.background = element_rect(fill = "transparent", color = NA),
                    axis.text.y = element_blank(),
                    axis.ticks.y = element_blank(),
                    axis.title = element_blank()))

file <- list.files("../../stanout", pattern = "sims", full.names = T, recursive = T)
ds <- str_remove_all(file, "\\.|\\/|stanout|all_sims.csv") %>% 
    str_to_upper() %>% 
    str_replace(., "PLANTRA", "PLanTra")
ds <- ds[-6]
plots <- list()
plots <- map(1:length(ds), ~get_pdens_plot(file[.], max_iki = 2000, ds = ds[.])) 
plots_fin <- plots[[1]] / plots[[2]] / plots[[3]] / plots[[4]] / plots[[5]] / plots[[6]] + plot_layout(guides = "collect") & theme(legend.position = 'bottom')
  
plots_fin <- grid.arrange(patchworkGrob(plots_fin), 
                            left = "Density",
                            bottom = "Transition duration in secs")
  
ggsave("../figures/fitplots.pdf", plots_fin, height = 8.5, width = 6.25)

```


```{r prediction, fig.cap="Fit to data with models (distribution type) above the plots. Comparison of 50 simulations to observed data summarised by model. For illustration the x-axis was truncated at 2 secs.", eval = T, fig.height=8, fig.width=6.5}
knitr::include_graphics("figures/fitplots.pdf")
```






